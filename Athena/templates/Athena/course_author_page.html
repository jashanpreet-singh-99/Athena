{% extends 'Athena/base.html' %}
{% load static %}

{% block stylesheets %}
    <link rel="stylesheet" type="text/css" href="{% static 'Athena/css/course_author_page.css' %}"/>
{% endblock %}

{% block page %}
<div class="info-container">
        <img class="course-banner" src="{{ course.course_banner.url }}" alt="course_banner">
        <div class="course-content">
            <h2 class="course-title">{{ course.course_title }}</h2>
            <p class="course-desc">{{ course.course_desc }}</p>
            <div class="content-footer">
                <div class="author-card">
                    <img class="author-profile-image" src="{{ author_profile.url }}" alt="author_profile">
                    <p class="course-author"> {{ course.author.first_name }} {{ course.author.last_name }}</p>
                </div>
                <button class="enroll-button">Edit</button>
            </div>
        </div>
    </div>

    <div class="tabbed-view">
        <div class="tab-container">
            <button class="tab" onclick="openTab(event, 'tab1')">Course Details</button>
            <button class="tab" onclick="openTab(event, 'tab2')">Content</button>
            <button class="tab" onclick="openTab(event, 'tab3')">Students</button>
            <button class="tab" onclick="openTab(event, 'tab4')">Grades</button>
        </div>
        <div id="tab1" class="tab-content">
            <div class="course-content-dates">
                <div>
                    <h3>Course Created on: </h3>
                    <p>{{ course.course_created }}</p>
                </div>
                <div>
                    <h3>Course Difficulty Level: </h3>
                    <p>{{ course.get_course_difficulty_display }}</p>
                </div>
                <p class="secondary-info"> Last updated on {{ course.last_update }}
            </div>
            <div class="course-content-dates">
                <div>
                    <h3>Course Starts: </h3>
                    <p>{{ course.course_start_date }}</p>
                </div>
                <div>
                    <h3>Course Ends:</h3>
                    <p>{{ course.course_end_date }}</p>
                </div>
                <p class="secondary-info"> Duration: {{ course.course_start_date|timesince:course.course_end_date }}
            </div>
            <div class="course-content-dates">
                <div>
                    <h3>Course Medium: </h3>
                    <p>{{ course.get_course_type_display }}</p>
                </div>
                <div>
                    <h3>Instructor: </h3>
                    <div class="author-card">
                        <img class="author-profile-image" src="{{ author_profile.url }}" alt="author_profile">
                        <p class="course-author"> {{ course.author.first_name }} {{ course.author.last_name }}</p>
                    </div>
                </div>
                <p class="secondary-info"> Weekly: {{ course.course_day }}
            </div>
            <h3 class="cat-title">Content Covered</h3>
            <div id="cat-container"></div>
            <h3 class="cat-title">Class Enrollments: </h3>
            {% if e_info|length < 2 %}
                <p>{{ e_info|length }} Student</p>
            {% else %}
                <p>{{ e_info|length }} Students</p>
            {% endif %}
        </div>
        <div id="tab2" class="tab-content">
            <div class="content-p-container">
                <div class="content-header">
                    <h2>Chapters:</h2>
                    <div>
                        <button class="expand-button content-buttons light content-buttons-120">
                            Expand
                        </button>
                    </div>
                </div>
                <div id="content-container" class="content-container">
                    {% for chapter in chapters %}
                        <div class="chapter-view-container">
                        <p>{{ chapter.title }}</p>
                        <div class="chapter-info-container">
                            <p>Visibility: {{ chapter.visibility }}</p>
                            <p>Streamable: {{ chapter.is_streaming }}</p>
                        </div>
                        </div>
                    {%  endfor %}
                    <form method="post" enctype="multipart/form-data" action="{% url 'create_chapter' %}">
                        {%  csrf_token %}
                        <div>
                            <h3>Chapter Title: </h3>
                            {{ c_form.course }}
                            {{ c_form.title }}
                            {{ c_form.visibility }}
                            <div class="toggle-div">
                                <button id="visible-button" class="toggle-btn sel">Visible</button>
                                <button id="hidden-button" class="toggle-btn ">Hidden</button>
                            </div>
                            {{ c_form.is_streaming }}
                            <div class="toggle-div large">
                                <button id="stream-button" class="toggle-btn large">Stream-Only</button>
                                <button id="no-stream-button" class="toggle-btn large sel">No Stream</button>
                            </div>
                        </div>
                        <div id="stream_video_file_div">
                            {{ c_form.video_file }}
                        </div>
                        <button class="content-buttons" type="submit">Add Chapter</button>
                    </form>
                </div>
            </div>
            <div class="content-p-container">
                <div class="content-header">
                    <h2>Assignments:</h2>
                    <div>
                        <button class="content-buttons content-buttons-200">
                            Add Assignment
                        </button>
                        <button class="expand-button content-buttons light content-buttons-120">
                            Expand
                        </button>
                    </div>
                </div>
                <div id="content-container" class="content-container">
                    <p>This is the expanded content Assignments.</p>
                </div>
            </div>
            <div class="content-p-container">
                <div class="content-header">
                    <h2>Quiz:</h2>
                    <div>
                        <button class="content-buttons content-buttons-200">
                            Add Quiz
                        </button>
                        <button class="expand-button content-buttons light content-buttons-120">Expand</button>
                    </div>
                </div>
                <div id="content-container" class="content-container">
                    <p>This is the expanded content Assignments.</p>
                </div>
            </div>
            <div class="content-p-container">
                <div class="content-header">
                    <h2>In-Person Exam:</h2>
                    <div>
                        <button class="content-buttons content-buttons-200">
                            Add Exam
                        </button>
                        <button class="expand-button content-buttons light content-buttons-120">
                            Expand
                        </button>
                    </div>
                </div>
                <div id="content-container" class="content-container">
                    <p>This is the expanded content Assignments.</p>
                </div>
            </div>
        </div>
        <div id="tab3" class="tab-content">
            {% for students in e_info %}
                <div>
                    <p>{{ students.user.first_name }} {{ students.user.last_name }}</p>
                    <p>{{ students.user.email }}</p>
                </div>
            {% endfor %}
        </div>
        <div id="tab4" class="tab-content"></div>
    </div>
{% endblock %}

{% block extrascripts %}
    <script>
        const course_categories = '{{ course.categories }}';
    </script>
    <script src="{% static 'AThena/js/course_author_page.js'%}"></script>
{% endblock %}